[bed_mesh]
speed: 100        
horizontal_move_z: 10
mesh_min: 10, 2
mesh_max: 190, 190
probe_count: 11,11
algorithm: bicubic

[gcode_macro BED_MESH_CALIBRATE]
rename_existing: BED_MESH_CALIBRATE_BASE
gcode:
    {% if printer.toolhead.position.z < 15 %}
        G90
        G1 Z15 F600
        {action_respond_info("Safety: Moving Z to safe height before mesh")}
    {% endif %}
    {action_respond_info("Starting bed mesh calibration")}
    {action_respond_info("Clearing load cell state...")}
    SET_PIN PIN=_level_clear VALUE=1
    G4 P100
    SET_PIN PIN=_level_clear VALUE=0
    G4 P500
    
    {action_respond_info("Taring load cell...")}
    SET_PIN PIN=_level_h1 VALUE=1
    G4 P500
    SET_PIN PIN=_level_h1 VALUE=0
    G4 P1000
    
    {action_respond_info("Load cell tared, starting mesh calibration")}
    BED_MESH_CALIBRATE_BAS
